<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System · Overview of Julia&#39;s SciML</title><meta name="title" content="Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System · Overview of Julia&#39;s SciML"/><meta property="og:title" content="Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System · Overview of Julia&#39;s SciML"/><meta property="twitter:title" content="Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System · Overview of Julia&#39;s SciML"/><meta name="description" content="Documentation for Overview of Julia&#39;s SciML."/><meta property="og:description" content="Documentation for Overview of Julia&#39;s SciML."/><meta property="twitter:description" content="Documentation for Overview of Julia&#39;s SciML."/><meta property="og:url" content="https://docs.sciml.ai/stable/showcase/ode_types/"/><meta property="twitter:url" content="https://docs.sciml.ai/stable/showcase/ode_types/"/><link rel="canonical" href="https://docs.sciml.ai/stable/showcase/ode_types/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Overview of Julia&#39;s SciML logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Overview of Julia&#39;s SciML</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">SciML: Open Source Software for Scientific Machine Learning with Julia</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/getting_started/">Getting Started with Julia&#39;s SciML</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">New User Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../getting_started/installation/">Installing SciML Software</a></li><li><a class="tocitem" href="../../getting_started/first_simulation/">Build and run your first simulation with Julia&#39;s SciML</a></li><li><a class="tocitem" href="../../getting_started/first_optimization/">Solve your first optimization problem</a></li><li><a class="tocitem" href="../../getting_started/fit_simulation/">Fit a simulation to a dataset</a></li><li><a class="tocitem" href="../../getting_started/find_root/">Find the root of an equation (i.e. solve f(u)=0)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Comparison With Other Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../comparisons/python/">Getting Started with Julia&#39;s SciML for the Python User</a></li><li><a class="tocitem" href="../../comparisons/matlab/">Getting Started with  Julia&#39;s SciML for the MATLAB User</a></li><li><a class="tocitem" href="../../comparisons/r/">Getting Started with Julia&#39;s SciML for the R User</a></li><li><a class="tocitem" href="../../comparisons/cppfortran/">Getting Started with Julia&#39;s SciML for the C++/Fortran User</a></li></ul></li></ul></li><li><span class="tocitem">Showcase of Cool Examples</span><ul><li><a class="tocitem" href="../showcase/">The SciML Showcase</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Automated Model Discovery</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../missing_physics/">Automatically Discover Missing Physics by Embedding Machine Learning into Differential Equations</a></li><li><a class="tocitem" href="../bayesian_neural_ode/">Uncertainty Quantified Deep Bayesian Model Discovery</a></li><li><a class="tocitem" href="../blackhole/">Discovering the Relativistic Corrections to Binary Black Hole Dynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Solving Difficult Equations Efficiently</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../brusselator/">Automated Efficient Solution of Nonlinear Partial Differential Equations</a></li><li><a class="tocitem" href="../pinngpu/">GPU-Accelerated Physics-Informed Neural Network (PINN) PDE Solvers</a></li><li><a class="tocitem" href="../massively_parallel_gpu/">Massively Data-Parallel ODE Solving on GPUs</a></li><li><a class="tocitem" href="../gpu_spde/">GPU-Accelerated Stochastic Partial Differential Equations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Useful Cool Wonky Things</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System</a><ul class="internal"><li><a class="tocitem" href="#How-Type-Support-Works-in-DifferentialEquations.jl-/-SciML"><span>How Type Support Works in DifferentialEquations.jl / SciML</span></a></li><li><a class="tocitem" href="#Arbitrary-Precision:-Rationals-and-BigFloats"><span>Arbitrary Precision: Rationals and BigFloats</span></a></li><li><a class="tocitem" href="#Unit-Checked-Arithmetic-via-Unitful.jl"><span>Unit Checked Arithmetic via Unitful.jl</span></a></li><li class="toplevel"><a class="tocitem" href="#Measurements.jl:-Numbers-with-Linear-Uncertainty-Propagation"><span>Measurements.jl: Numbers with Linear Uncertainty Propagation</span></a></li></ul></li><li><a class="tocitem" href="../symbolic_analysis/">Symbolic-Numeric Analysis of Parameter Identifiability and Model Stability</a></li><li><a class="tocitem" href="../optimization_under_uncertainty/">Optimization Under Uncertainty</a></li></ul></li></ul></li><li><span class="tocitem">What is SciML?</span><ul><li><a class="tocitem" href="../../overview/">Detailed Overview of the SciML Software Ecosystem</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/equation_solvers/">Equation Solvers</a></li><li><a class="tocitem" href="../../highlevels/inverse_problems/">Parameter Estimation, Bayesian Analysis, and Inverse Problems</a></li><li><a class="tocitem" href="../../highlevels/partial_differential_equation_solvers/">Partial Differential Equations (PDE)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Modeling Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/modeling_languages/">Modeling Languages</a></li><li><a class="tocitem" href="../../highlevels/model_libraries_and_importers/">Model Libraries and Importers</a></li><li><a class="tocitem" href="../../highlevels/symbolic_tools/">Symbolic Model Tooling and JuliaSymbolics</a></li><li><a class="tocitem" href="../../highlevels/array_libraries/">Modeling Array Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Simulation Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/parameter_analysis/">Parameter Analysis Utilities</a></li><li><a class="tocitem" href="../../highlevels/uncertainty_quantification/">Uncertainty Quantification</a></li><li><a class="tocitem" href="../../highlevels/plots_visualization/">SciML-Supported Plotting and Visualization Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Machine Learning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/function_approximation/">Function Approximation</a></li><li><a class="tocitem" href="../../highlevels/implicit_layers/">Implicit Layer Deep Learning</a></li><li><a class="tocitem" href="../../highlevels/symbolic_learning/">Symbolic Learning and Artificial Intelligence</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Developer Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/numerical_utilities/">SciML Numerical Utility Libraries</a></li><li><a class="tocitem" href="../../highlevels/interfaces/">The SciML Interface Libraries</a></li><li><a class="tocitem" href="../../highlevels/developer_documentation/">Developer Documentation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Extra Learning Resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../highlevels/learning_resources/">Curated Learning, Teaching, and Training Resources</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Showcase of Cool Examples</a></li><li><a class="is-disabled">Useful Cool Wonky Things</a></li><li class="is-active"><a href>Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/SciMLDocs" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/SciMLDocs/blob/main/docs/src/showcase/ode_types.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ode_types"><a class="docs-heading-anchor" href="#ode_types">Automatic Uncertainty Quantification, Arbitrary Precision, and Unit Checking in ODE Solutions using Julia&#39;s Type System</a><a id="ode_types-1"></a><a class="docs-heading-anchor-permalink" href="#ode_types" title="Permalink"></a></h1><p>One of the nice things about DifferentialEquations.jl is that it is designed with Julia&#39;s type system in mind. What this means is, if you have properly defined a Number type, you can use this number type in DifferentialEquations.jl&#39;s algorithms! There&#39;s more than a few useful/interesting types that can be used:</p><table><tr><th style="text-align: left">Julia Type Name</th><th style="text-align: left">Julia Package</th><th style="text-align: left">Use case</th></tr><tr><td style="text-align: left">BigFloat</td><td style="text-align: left">Base Julia</td><td style="text-align: left">Higher precision solutions</td></tr><tr><td style="text-align: left">ArbFloat</td><td style="text-align: left"><a href="https://github.com/JuliaArbTypes/ArbFloats.jl">ArbFloats.jl</a></td><td style="text-align: left">More efficient higher precision solutions</td></tr><tr><td style="text-align: left">Measurement</td><td style="text-align: left"><a href="https://github.com/JuliaPhysics/Measurements.jl">Measurements.jl</a></td><td style="text-align: left">Uncertainty propagation</td></tr><tr><td style="text-align: left">Particles</td><td style="text-align: left"><a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl">MonteCarloMeasurements.jl</a></td><td style="text-align: left">Uncertainty propagation</td></tr><tr><td style="text-align: left">Unitful</td><td style="text-align: left"><a href="https://painterqubits.github.io/Unitful.jl/stable/">Unitful.jl</a></td><td style="text-align: left">Unit-checked arithmetic</td></tr><tr><td style="text-align: left">Quaternion</td><td style="text-align: left"><a href="https://juliageometry.github.io/Quaternions.jl/stable/">Quaternions.jl</a></td><td style="text-align: left">Quaternions, duh.</td></tr><tr><td style="text-align: left">Fun</td><td style="text-align: left"><a href="https://juliaapproximation.github.io/ApproxFun.jl/latest/">ApproxFun.jl</a></td><td style="text-align: left">Representing PDEs as ODEs in function spaces</td></tr><tr><td style="text-align: left">AbstractOrthoPoly</td><td style="text-align: left"><a href="https://docs.sciml.ai/PolyChaos/stable/">PolyChaos.jl</a></td><td style="text-align: left">Polynomial Chaos Expansion (PCE) for uncertainty quantification</td></tr><tr><td style="text-align: left">Num</td><td style="text-align: left"><a href="https://symbolics.juliasymbolics.org/stable/">Symbolics.jl</a></td><td style="text-align: left">Build symbolic expressions of ODE solution approximations</td></tr><tr><td style="text-align: left">Taylor</td><td style="text-align: left"><a href="https://github.com/JuliaDiff/TaylorSeries.jl">TaylorSeries.jl</a></td><td style="text-align: left">Build a Taylor series around a solution point</td></tr><tr><td style="text-align: left">Dual</td><td style="text-align: left"><a href="https://juliadiff.org/ForwardDiff.jl/stable/">ForwardDiff.jl</a></td><td style="text-align: left">Perform forward-mode automatic differentiation</td></tr><tr><td style="text-align: left">TrackedArray\TrackedReal</td><td style="text-align: left"><a href="https://juliadiff.org/ReverseDiff.jl/">ReverseDiff.jl</a></td><td style="text-align: left">Perform reverse-mode automatic differentiation</td></tr></table><p>and on and on. That&#39;s only a subset of types people have effectively used on the SciML tools.</p><p>We will look into the <code>BigFloat</code>, <code>Measurement</code>, and <code>Unitful</code> cases to demonstrate the utility of alternative numerical types.</p><h2 id="How-Type-Support-Works-in-DifferentialEquations.jl-/-SciML"><a class="docs-heading-anchor" href="#How-Type-Support-Works-in-DifferentialEquations.jl-/-SciML">How Type Support Works in DifferentialEquations.jl / SciML</a><a id="How-Type-Support-Works-in-DifferentialEquations.jl-/-SciML-1"></a><a class="docs-heading-anchor-permalink" href="#How-Type-Support-Works-in-DifferentialEquations.jl-/-SciML" title="Permalink"></a></h2><p>DifferentialEquations.jl determines the numbers to use in its solvers via the types that are designated by <code>tspan</code> and the initial condition <code>u0</code> of the problem. It will keep the time values in the same type as tspan, and the solution values in the same type as the initial condition.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Support for this feature is restricted to the native algorithms of OrdinaryDiffEq.jl. The other solvers such as Sundials.jl, and ODEInterface.jl are incompatible with some number systems.</p></div></div><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>Adaptive timestepping requires that the time type is compatible with <code>sqrt</code> and <code>^</code> functions. Thus for example, <code>tspan</code> cannot be <code>Int</code> if adaptive timestepping is chosen.</p></div></div><p>Let&#39;s use this feature in some cool ways!</p><h2 id="Arbitrary-Precision:-Rationals-and-BigFloats"><a class="docs-heading-anchor" href="#Arbitrary-Precision:-Rationals-and-BigFloats">Arbitrary Precision: Rationals and BigFloats</a><a id="Arbitrary-Precision:-Rationals-and-BigFloats-1"></a><a class="docs-heading-anchor-permalink" href="#Arbitrary-Precision:-Rationals-and-BigFloats" title="Permalink"></a></h2><p>Let&#39;s solve the linear ODE. First, define an easy way to get <code>ODEProblem</code>s for the linear ODE:</p><pre><code class="language-julia hljs">using DifferentialEquations
f(u, p, t) = p * u
prob_ode_linear = ODEProblem(f, 1 / 2, (0.0, 1.0), 1.01);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">ODEProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Float64</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">false</span>
timespan: (0.0, 1.0)
u0: 0.5</code></pre><p>Next, let&#39;s solve it using Float64s. To do so, we just need to set u0 to a Float64 (which is done by the default) and dt should be a float as well.</p><pre><code class="language-julia hljs">sol = solve(prob_ode_linear, Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 5-element Vector{Float64}:
 0.0
 0.09964258706516003
 0.3457024247583422
 0.6776921908052249
 1.0
u: 5-element Vector{Float64}:
 0.5
 0.552938681151017
 0.7089376245893467
 0.9913594502399238
 1.3728004409033037</code></pre><p>Notice that both the times and the solutions were saved as Float64. Let&#39;s change the state to use <code>BigFloat</code> values. We do this by changing the <code>u0</code> to use <code>BigFloat</code>s like:</p><pre><code class="language-julia hljs">prob_ode_linear_bigu = ODEProblem(f, big(1 / 2), (0.0, 1.0), 1.01);
sol = solve(prob_ode_linear_bigu, Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 5-element Vector{Float64}:
 0.0
 0.09964258706516002
 0.3457024247583421
 0.6776921908052249
 1.0
u: 5-element Vector{BigFloat}:
 0.5
 0.5529386811510169868158546583396554107562766958646715721373574023383501046220971
 0.7089376245893467747946683740114247908183375873155184947921708376129135715459128
 0.9913594502399245129177568740015245483252784799862388832829909311574503717102782
 1.372800440903305197219668813808289181933806034675853174012933503735877101067405</code></pre><p>Now we see that <code>u</code> is in arbitrary precision <code>BigFloat</code>s, while <code>t</code> is in <code>Float64</code>. We can then change <code>t</code> to be arbitrary precision <code>BigFloat</code>s by changing the types of the <code>tspan</code> like:</p><pre><code class="language-julia hljs">prob_ode_linear_big = ODEProblem(f, big(1 / 2), (big(0.0), big(1.0)), 1.01);
sol = solve(prob_ode_linear_big, Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 5-element Vector{BigFloat}:
 0.0
 0.09964258706516002757241113786493079821949560824572094442904017056206815655027755
 0.3457024247583421308145661100153752226739293846153111762313695785692066646211486
 0.6776921908052248538004732061437054858600791539496176542941317413488563178090448
 1.0
u: 5-element Vector{BigFloat}:
 0.5
 0.5529386811510169905121549222942681803517017137036250612133811084046740072664042
 0.7089376245893467829092172805583925956947513313925386404738921107616392796707356
 0.9913594502399245078379256583106538498562594798883926568710576464510438939970478
 1.372800440903305274187428016868058103324428725450247680936213844886721036701333</code></pre><p>Now let&#39;s send it into the bizarre territory. Let&#39;s use rational values for everything. Let&#39;s start by making the time type <code>Rational</code>. Rationals are incompatible with adaptive time stepping since they do not have an L2 norm (this can be worked around by defining <code>internalnorm</code>, but we will skip that in this tutorial). To account for this, let&#39;s turn off adaptivity as well. Thus the following is a valid use of rational time (and parameter):</p><pre><code class="language-julia hljs">prob = ODEProblem(f, 1 / 2, (0 // 1, 1 // 1), 101 // 100);
sol = solve(prob, RK4(), dt = 1 // 2^(6), adaptive = false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 3rd order Hermite
t: 65-element Vector{Rational{Int64}}:
  0//1
  1//64
  1//32
  3//64
  1//16
  5//64
  3//32
  7//64
  1//8
  9//64
   ⋮
  7//8
 57//64
 29//32
 59//64
 15//16
 61//64
 31//32
 63//64
  1//1
u: 65-element Vector{Float64}:
 0.5
 0.5079532157789419
 0.5160329388403366
 0.5242411814636141
 0.5325799879363893
 0.5410514350635981
 0.549657632684732
 0.5584007241993002
 0.5672828871006491
 0.5763063335182743
 ⋮
 1.2099787760366485
 1.2292252206241676
 1.2487778074652507
 1.268641406190701
 1.288820963889771
 1.3093215063422494
 1.3301481392701477
 1.3513060496092948
 1.3728005068011595</code></pre><p>Now let&#39;s change the state to use <code>Rational{BigInt}</code>. You will see that we will need to use the arbitrary-sized integers because... well... there&#39;s a reason people use floating-point numbers with ODE solvers:</p><pre><code class="language-julia hljs">prob = ODEProblem(f, BigInt(1) // BigInt(2), (0 // 1, 1 // 1), 101 // 100);
sol = solve(prob, RK4(), dt = 1 // 2^(6), adaptive = false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 3rd order Hermite
t: 65-element Vector{Rational{Int64}}:
  0//1
  1//64
  1//32
  3//64
  1//16
  5//64
  3//32
  7//64
  1//8
  9//64
   ⋮
  7//8
 57//64
 29//32
 59//64
 15//16
 61//64
 31//32
 63//64
  1//1
u: 65-element Vector{Rational{BigInt}}:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1//2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         13635265310428667//26843545600000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         185920460085779372649467295396889//360287970189639680000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2535074799906565070064434989240252460736488216963//4835703278458516698824704000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         34566417478507880850358857402427148787055026137565875648030878321//64903710731685345356631204115251200000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         471322273150493660801770967151032391984466213543795788952681156195576797027228107//871122859317602466466238995025326621327360000000000000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         6426604241121310927369897121054534260287845822775576065191752910027218849129163851685338960943369//11692013098647223345629478661730264157247460343808000000000000000000000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         87628453872815159549919436744286633306700458799675030242287144817323241473991649398590738650552963396600101159123//156927543384667019095894735580191660402558886111600862822400000000000000000000000000000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1194837217298495123489429765132896187014406474671976544708139096975464385034479106227218239981906730284477718437811007486707779041//2106245833371143733958360553673408646377901908010982225086219550720000000000000000000000000000000000000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        16291922460639289757947281837298870307759032284133099989470765273134679312684297502599368900453650828381789478033888032849237996811196931228168347//28269553036454149273332760011886696253239742350009903329945699220681916416000000000000000000000000000000000000000000000000000000000000000000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ⋮
                                                                                                                                  3476651764144701299310823013868414852914252425511969801823326943470139627183050321356269729758757892616986280081068426854388132587192659833281759109495586510217757379507472058821725242337421483829232094724350000335051444864163716743131954661196447426549808629937028209252581525400046451480100419001530953781616768025169970806686494551090052818656160455734295279711817930495039244376027618813690810243490836308240922572885036008357232995165091370374018505314343843108268301984782218425989406930319958551532270117232742567343778042005440462725562350111368484320102066864357344195777652146963879004877113342262696777549666508001903654324815937791481538838675335919013649404331120990596974956064711019198691285927797569234244700072843046601685002725165218418237056611786017220421490343908940716757353909791039304274005391221502042135010059552204316515216866746639520694954996904124971579780497757666750446881//2873316320086756454205652005706207886829487380916701497268289374190875758638147354923588066229040681914626081324682241425350209449285219103061691508162945093459145235278159647906758878132917284580285004541144156524655039141064404379679426100372681576010961105039478156124917692281743798746817307433826768839799128901030530861680784239247749388313984379590631715911498407693680085160154180294124335267854340370884940503485168233544639735700169786044364881920000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                                                                                  47405069196082873328585408620421318517516390291920914673056124180124925970261893410339173429287494238135595611089781966147422284876218622543131269354235054173066292325370254052047479196233718967762509800342189006216218284815334686783879790109432868299224476127915815042082361972609813617003873110744660057301821702132621624893170611073772099444022185151482507338829550979383225592740578974181160289252871652171292405008199989659405158877156438081779650473274842639963837184419397179015646801970478919138945275747462931559006763638612060474604554509550795966812356642042917363452960338457115020031120789490076363823059477978169077204763046262491762113637668511018482223361774121845706177451044161738746050766877434757946831223565527239248794315463305271779949208058882442095280247508627968155300497343796852202862275891120750390256408617409094008210261398024974884224628684715716894544417457681835995541069229911923137627//38564998830736521417281865696453025806593491967131023221754800625044118265468851210705360385717536794615180260494208076605798671660719333199513807806252394423283413430106003596332513246682903994829528690198205120921557533726473585751382193953592127439965050261476810842071573684505878854588706623484573925925903505747545471088867712185004135201289273405614415899438276535626346098904241020877974002916168099951885406379295536200413493190419727789712076165429067776000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                                                                  646380695547819379379462110595350483323442009248798219582259024446464544132551698473809581856967370658487548204659626702292564992976158496529375784071763787592253430041646066314009418251081347658033077807894727674506660673057920454240886643468816490881054458605117293952007109054634081637211268136338650821833722847677488664849766203163787324732106652618777185431293544445474668250279073481131086314724562094446770240396090985922895943040057962860047030005371781373835035785147257040477418516657611117881834875218299885716266834779541157085670534199549342497110048855301431141761423177209449504715692545645531288355844442793377192971285135291013238861059535547536381876669229982900292241340160011803760056601165836520905723932492682377301319454029065863067972071145347687240835433388266357742534589282848560823758438409092468036851229133683325521477136527739510675196517661031060688353455828921203165442555541627063437450443175007153209//517610652338411247125091194937906278248634591141457661513916951298640145335453006427092274839221143832965212887398076520128024933571973574771371398838386057405297005067351460185957906049968291062814308810921896100805671839805065813156369093210647278367856544550122347590861343331896786250613857746265095538581506488867049470623751042202917069732186894727238934606968195284747923033659051938664223591447345684161896856058575310936125171656160723031361663708684162205273292800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                                                  8813572275333935103416906132960621777114439444141647438438393753862988179987938832721184273969585102967467754980010070157566337119239854562632863958739529252701552386911176964405034482000877845003064456723043889756774450867335661101187923620690769719662220354335695798311755154012564019508697637433705198641352232164934271731689599505104756286149010104803971173588887614751600240293596938071050020381715583108625023759753393738598032521536448316590020179966102744430869710510004750450586729772303515586404571938281315619339180632083313992191945702244726898267871642409305486953268724327679433424951407071104066109102285627362450306825448652531631455682741766958888491690416428140178416796287551293015562399117395448453688862961061347809034853245381286200796207330060769671545355757344311231491079771497941834167729303081908176522671807233326506847483489756135442309818267518863626272611798974800987095037233771816523002200031070842864277033671134642403//6947252574545944471877627197737088174346755392521537393659097358399012979651430037341372277527182721482180237678288966210172977571138121768185158859627001581181653918534439996364172765366419849849364181449231848010219624385221589633232036842015330311191725363944820361567168306503513658105903059201890160889134614375299267401072260772210764407187169348166518951608784413937917928229658547784150744532806296935881538019052501315074027366329988944810663524927964212077525097869475840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                                 120175396306816661567962374621260628614816898908130603456791258506661752158816764138355946608581111648754811275356266553194146487289970011521206302938350516439692698830565485671063124957581001985813711933633645259078108062496048585468892270573397374250419348298467866026065051327496126625966211919529492809946883329115587011078666703280156236855586771535787690208072551405979966710615670765008341976837702247734425622133716186858699168908901364438717264342619451907519562821993757807949284311972035986557650598491323972524603931519064752851585706054312058594719949638576121660783232383108957295631067768960287620832338037163277354938280475722726742662910468041915790311921524235141338322754706846323314939020948898862794933449368601120381306723818943912893036079998982040701877643402517997677027213445418199720233720320010396665109155653989028150312257462380364161291864607152883841218256979741199145521849881542278617665978410806969940456720443825181089585213684966801//93244445639770729862957501651127871609648939295598894004396565397511723957132517156291414749188392311819502398767993997219818753659311707791315470545820707967860914422798962606432752916695795974088280267869564598517299876599783853712075728174759257553768635074864690629768384949250922720794309199432719070009410782760880699063638360466965433587592874066215113935387298888055887737745183249936814734070168263882738171006284743922624810491863481443760464848830272021035557849901868779569152000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                 1638623412429354568616301751922853165062178143570237809868003552419139731525207008014840385057094808550364022265598937908854560007761359201302534206737402807692400464255340884583551113600457074478398193829260671903408623257256918638344550520063772668911716725034710930551991674894972611899808216730842062998272110294468577188489521117566036367472120519200995130413089843947574203037759878714438894957215775888827327087684601532223092366221531321381581156578870580679772475683937879311488116796619715835741276270959196507639605482261723621713433086664848878328456065693446846127336706287037161239359880305409587491274511777885262373075163575581721009527514233124879843185501554931387437408536169975692089151929986328911859307334752043996902855680228690265685371832496623752200243917392455804140656929928494581593961635191153288675520454159469305085294704574693513943256409827056994632177252792094052051470442150934455756986752540284228302747677207523056397782475349694314971666973684267//1251505764238953380310790723217063156492278350986520395258292901865744044288949584763845459354175586006508115805319015342448238968794450346355026058791097531879778895383050816179236228126428300279367584898068436076222415813190335413631917039956177449583366403740944868375040179411785414948859053607735844243893605388086697470737326815552111955066160454615751415166882205681178758918321833875017541716382217695604557573133901205035650986064847896555168936823386256828536078182639385054790440032665600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                 22343064972354224957479728113350949780887535331771171875613387648500150040113223878247360980060744795749139600967047698773976023825716749550816790048959630214024291450253822775597752506859958652993156369432205621106046955897352932772730437075711261897922223752076981370603845666571148563739751397868267477530534170057941586126867460170518844864494697419135689305804862898660459973467138685238383474453740580946286484621665119314190873607079738136863819984192230557369652571594272717804907202344994813159997266200695798241334728503709447203221423207356469728025768552535361151641594813114163751201865741331096235472064289773307514336130797690384014695762583913450057967476452114645805950514182594981422860829708262919876496710557833096659829409940579069682311025892212895827818852274344280241244125649458665933112767576600946408242226001592726350162502705017014799678405577891527233732317745485132196617377835361746048692485877388072155967761600004670740471374233078485232398111732065728284486083682089//16797426025505597180323426475367106769690204981299732607723004644694712665399418877354675409763379446686211251695080855446054459199265402449658467899173553735531149248066277025612272731441890321839848252186585707866380747311767925077561613338740335684791398530164032080655694478936221481797309836746050823857727758891755480154571048997687953221061814590197326795648367049015650538387689411549829040931804163870543930391122605951634723435058354534121380135661044065795059797970422730537112837730462261575680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                 304653618746195407227163730322053916014053723110422517841663212509580133414870563836575120110686536695480977952772624365535866244332873061241508781399832428387630674513930691330101904718500293023050050607427115063669681175960942195506424032272471651202997578108749930421242453943184047368369010644749823498643293649551273090398280784531128183631032000069615743032947667239062468509040079935236177208481442271959808690696140664325113131314265183037989326932456072811588119452547655042672272627027134583718064095094039463733284097409615865832861209712359926308642772539377944587409962967122237590175479982785779905543006714406871097094026357618247456813205608858618077379847671759450329112666484299745038339155180488295039857022873030587080343463926426043822286460042109518151839354796204791318240797287518363486427798004869303012233120170679276644118435222844774404863091415468587316888561285613163612304906504998288703317237135069355519646441949776015247310544320628566775036316038856240879188327554671006066340045363//225451235739143130482621660669882103656123857644433259761609693674437158756273421423885518367590980693612040313054990119426585607799410158579879393738800746006890372530436409579627705493048468302253321227325456578709735148712759856718454352234022223757002566466115585318472006322496350419162828280010585455071241504098321847789561501104635433430119850185353627418544411222894525170437245598787501266228575781564409246128662754026769046536188789298827011803275711261889543970772915009224750475981532113842946965504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
 4154032919386558883432944248380343483762044089219885824293861963690668280133800624271545564442460641100421478069957127705133139131053171319939289915624722195403241736871340745589519387833493153871994750550507166424767604170338332253959630697516305444248796250106488696552824425774652891031781638156634640665726706553562695794716367646798636566490125595141712720380867485868916531456648814528917577693417533965049279568879801863167212171389128029079788394889712773514836798543384276326561054294342851708282050876790968869065128360584151770000714515194551497614161342119347668187950856166437783338125107242946094385126468080818490755092469614835748767521966870937090173768929887202086899128132689201712566935821453568568851761907310360889009454819233203019261511646422045122043461427963067831419822632761257565485308244276118163333934078610669354885645888806741789229076806586507072844471249752898840782835318816592414922484506856439857852070928805249944302969170900303083044962139908567605824428891872081720287044135359380045755621121//3025955263570019164018502277869853398058543745963126397283707470775892712704232437030043920740033026198847216426264951289188498307633591122471111874163926157374989814610878574225506571713008520940845805558579429855707382314196875257835647882856218717417250856125102284683546912020709544155188247379716859572950811281937944702307676679453365814328593305957854274867553594143460475201489987084725797475032257007739929467758191052369579260681352907875927458926484892315482757871323905647524505025315981027903769053444125491200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></pre><p>Yeah...</p><pre><code class="language-julia hljs">sol[end]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4154032919386558883432944248380343483762044089219885824293861963690668280133800624271545564442460641100421478069957127705133139131053171319939289915624722195403241736871340745589519387833493153871994750550507166424767604170338332253959630697516305444248796250106488696552824425774652891031781638156634640665726706553562695794716367646798636566490125595141712720380867485868916531456648814528917577693417533965049279568879801863167212171389128029079788394889712773514836798543384276326561054294342851708282050876790968869065128360584151770000714515194551497614161342119347668187950856166437783338125107242946094385126468080818490755092469614835748767521966870937090173768929887202086899128132689201712566935821453568568851761907310360889009454819233203019261511646422045122043461427963067831419822632761257565485308244276118163333934078610669354885645888806741789229076806586507072844471249752898840782835318816592414922484506856439857852070928805249944302969170900303083044962139908567605824428891872081720287044135359380045755621121//3025955263570019164018502277869853398058543745963126397283707470775892712704232437030043920740033026198847216426264951289188498307633591122471111874163926157374989814610878574225506571713008520940845805558579429855707382314196875257835647882856218717417250856125102284683546912020709544155188247379716859572950811281937944702307676679453365814328593305957854274867553594143460475201489987084725797475032257007739929467758191052369579260681352907875927458926484892315482757871323905647524505025315981027903769053444125491200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></pre><p>That&#39;s one huge fraction! 0 floating-point error ODE solve achieved.</p><h2 id="Unit-Checked-Arithmetic-via-Unitful.jl"><a class="docs-heading-anchor" href="#Unit-Checked-Arithmetic-via-Unitful.jl">Unit Checked Arithmetic via Unitful.jl</a><a id="Unit-Checked-Arithmetic-via-Unitful.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-Checked-Arithmetic-via-Unitful.jl" title="Permalink"></a></h2><p>Units and dimensional analysis are standard tools across the sciences for checking the correctness of your equation. However, most ODE solvers only allow for the equation to be in dimensionless form, leaving it up to the user to both convert the equation to a dimensionless form, punch in the equations, and hopefully not make an error along the way.</p><p>DifferentialEquations.jl allows for one to use Unitful.jl to have unit-checked arithmetic natively in the solvers. Given the dispatch implementation of the Unitful, this has little overhead because the unit checks occur at compile-time and not at runtime, and thus it does not have a runtime effect unless conversions are required (i.e. converting <code>cm</code> to <code>m</code>), which automatically adds a floating-point operation for the multiplication.</p><p>Let&#39;s see this in action.</p><h3 id="Using-Unitful"><a class="docs-heading-anchor" href="#Using-Unitful">Using Unitful</a><a id="Using-Unitful-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Unitful" title="Permalink"></a></h3><p>To use Unitful, you need to have the package installed. Then you can add units to your variables. For example:</p><pre><code class="language-julia hljs">using Unitful
t = 1.0u&quot;s&quot;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0 s</code></pre><p>Notice that <code>t</code> is a variable with units in seconds. If we make another value with seconds, they can add:</p><pre><code class="language-julia hljs">t2 = 1.02u&quot;s&quot;
t + t2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.02 s</code></pre><p>and they can multiply:</p><pre><code class="language-julia hljs">t * t2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.02 s^2</code></pre><p>You can even do rational roots:</p><pre><code class="language-julia hljs">sqrt(t)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0 s^1/2</code></pre><p>Many operations work. These operations will check to make sure units are correct, and will throw an error for incorrect operations:</p><pre><code class="language-julia hljs">#t + sqrt(t)</code></pre><h3 id="Using-Unitful-with-DifferentialEquations.jl"><a class="docs-heading-anchor" href="#Using-Unitful-with-DifferentialEquations.jl">Using Unitful with DifferentialEquations.jl</a><a id="Using-Unitful-with-DifferentialEquations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Unitful-with-DifferentialEquations.jl" title="Permalink"></a></h3><p>Just like with other number systems, you can choose the units for your numbers by simply specifying the units of the initial condition and the timespan. For example, to solve the linear ODE where the variable has units of Newton&#39;s and <code>t</code> is in seconds, we would use:</p><pre><code class="language-julia hljs">using DifferentialEquations
f(u, p, t) = 0.5 * u
u0 = 1.5u&quot;N&quot;
prob = ODEProblem(f, u0, (0.0u&quot;s&quot;, 1.0u&quot;s&quot;))
#sol = solve(prob,Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">ODEProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Unitful.Quantity{Float64, 𝐋 𝐌 𝐓^-2, Unitful.FreeUnits{(N,), 𝐋 𝐌 𝐓^-2, nothing}}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(s,), 𝐓, nothing}}</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">false</span>
timespan: (0.0 s, 1.0 s)
u0: 1.5 N</code></pre><p>Notice that we received a unit mismatch error. This is correctly so! Remember that for an ODE:</p><p class="math-container">\[\frac{dy}{dt} = f(t,y)\]</p><p>we must have that <code>f</code> is a rate, i.e. <code>f</code> is a change in <code>y</code> per unit time. So, we need to fix the units of <code>f</code> in our example to be <code>N/s</code>. Notice that we then do not receive an error if we do the following:</p><pre><code class="language-julia hljs">f(y, p, t) = 0.5 * y / 3.0u&quot;s&quot;
prob = ODEProblem(f, u0, (0.0u&quot;s&quot;, 1.0u&quot;s&quot;))
sol = solve(prob, Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 3-element Vector{Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(s,), 𝐓, nothing}}}:
                 0.0 s
 0.14311598261241779 s
                 1.0 s
u: 3-element Vector{Unitful.Quantity{Float64, 𝐋 𝐌 𝐓^-2, Unitful.FreeUnits{(N,), 𝐋 𝐌 𝐓^-2, nothing}}}:
                1.5 N
 1.5362091208988309 N
 1.7720406194871123 N</code></pre><p>This gives a normal solution object. Notice that the values are all with the correct units:</p><pre><code class="language-julia hljs">print(sol[:])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Unitful.Quantity{Float64, 𝐋 𝐌 𝐓^-2, Unitful.FreeUnits{(N,), 𝐋 𝐌 𝐓^-2, nothing}}[1.5 N, 1.5362091208988309 N, 1.7720406194871123 N]</code></pre><p>And when we plot the solution, it automatically adds the units:</p><pre><code class="language-julia hljs">using Plots
gr()
plot(sol, lw = 3)</code></pre><img src="72b21edb.svg" alt="Example block output"/><h1 id="Measurements.jl:-Numbers-with-Linear-Uncertainty-Propagation"><a class="docs-heading-anchor" href="#Measurements.jl:-Numbers-with-Linear-Uncertainty-Propagation">Measurements.jl: Numbers with Linear Uncertainty Propagation</a><a id="Measurements.jl:-Numbers-with-Linear-Uncertainty-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#Measurements.jl:-Numbers-with-Linear-Uncertainty-Propagation" title="Permalink"></a></h1><p>The result of a measurement should be given as a number with an attached uncertainty, besides the physical unit, and all operations performed involving the result of the measurement should propagate the uncertainty, taking care of correlation between quantities.</p><p>There is a Julia package for dealing with numbers with uncertainties: <a href="https://github.com/JuliaPhysics/Measurements.jl"><code>Measurements.jl</code></a>. Thanks to Julia&#39;s features, <code>DifferentialEquations.jl</code> easily works together with <code>Measurements.jl</code> out-of-the-box.</p><p>Let&#39;s try to automate uncertainty propagation through number types on some classical physics examples!</p><h3 id="Warning-about-Measurement-type"><a class="docs-heading-anchor" href="#Warning-about-Measurement-type">Warning about <code>Measurement</code> type</a><a id="Warning-about-Measurement-type-1"></a><a class="docs-heading-anchor-permalink" href="#Warning-about-Measurement-type" title="Permalink"></a></h3><p>Before going on with the tutorial, we must point up a subtlety of <code>Measurements.jl</code> that you should be aware of:</p><pre><code class="language-julia hljs">using Measurements
5.23 ± 0.14 === 5.23 ± 0.14</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">(5.23 ± 0.14) - (5.23 ± 0.14)</code></pre><p class="math-container">\[0.0 \pm 0.2\]</p><pre><code class="language-julia hljs">(5.23 ± 0.14) / (5.23 ± 0.14)</code></pre><p class="math-container">\[1.0 \pm 0.038\]</p><p>The two numbers above, even though have the same nominal value and the same uncertainties, are actually two different measurements that only by chance share the same figures and their difference and their ratio have a non-zero uncertainty.  It is common in physics to get very similar, or even equal, results for a repeated measurement, but the two measurements are not the same thing.</p><p>Instead, if you have <em>one measurement</em> and want to perform some operations involving it, you have to assign it to a variable:</p><pre><code class="language-julia hljs">x = 5.23 ± 0.14
x === x</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">x - x</code></pre><p class="math-container">\[0.0 \pm 0.0\]</p><pre><code class="language-julia hljs">x / x</code></pre><p class="math-container">\[1.0 \pm 0.0\]</p><p>With that in mind, let&#39;s start using Measurements.jl for realsies.</p><h3 id="Automated-UQ-on-an-ODE:-Radioactive-Decay-of-Carbon-14"><a class="docs-heading-anchor" href="#Automated-UQ-on-an-ODE:-Radioactive-Decay-of-Carbon-14">Automated UQ on an ODE: Radioactive Decay of Carbon-14</a><a id="Automated-UQ-on-an-ODE:-Radioactive-Decay-of-Carbon-14-1"></a><a class="docs-heading-anchor-permalink" href="#Automated-UQ-on-an-ODE:-Radioactive-Decay-of-Carbon-14" title="Permalink"></a></h3><p>The rate of decay of carbon-14 is governed by a first order linear ordinary differential equation:</p><p class="math-container">\[\frac{\mathrm{d}u(t)}{\mathrm{d}t} = -\frac{u(t)}{\tau}\]</p><p>where <span>$\tau$</span> is the mean lifetime of carbon-14, which is related to the half-life <span>$t_{1/2} = (5730 \pm 40)$</span> years by the relation <span>$\tau = t_{1/2}/\ln(2)$</span>. Writing this in DifferentialEquations.jl syntax, this looks like:</p><pre><code class="language-julia hljs"># Half-life and mean lifetime of radiocarbon, in years
t_12 = 5730 ± 40
τ = t_12 / log(2)

#Setup
u₀ = 1 ± 0
tspan = (0.0, 10000.0)

#Define the problem
radioactivedecay(u, p, t) = -u / τ

#Pass to solver
prob = ODEProblem(radioactivedecay, u₀, tspan)
sol = solve(prob, Tsit5(), reltol = 1e-8)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 15-element Vector{Float64}:
     0.0
     0.15287276015505386
     1.6816003617055924
    16.968876377210975
   169.84163653226483
   630.950980263131
  1273.5405688759733
  2036.820743933165
  2960.4188421148647
  4014.4723211748314
  5207.541628507064
  6524.062666423843
  7962.817489456584
  9515.823531448306
 10000.0
u: 15-element Vector{Measurements.Measurement{Float64}}:
        1.0 ± 0.0
 0.99998151 ± 1.3e-7
  0.9997966 ± 1.4e-6
   0.997949 ± 1.4e-5
    0.97966 ± 0.00014
    0.92652 ± 0.00049
    0.85722 ± 0.00092
     0.7816 ± 0.0013
      0.699 ± 0.0017
     0.6153 ± 0.0021
     0.5326 ± 0.0023
     0.4542 ± 0.0025
     0.3817 ± 0.0026
     0.3163 ± 0.0025
     0.2983 ± 0.0025</code></pre><p>And bingo: numbers with uncertainty went in, so numbers with uncertainty came out. But can we trust those values for the uncertainty?</p><p>We can check the uncertainty quantification by evaluating an analytical solution to the ODE. Since it&#39;s a linear ODE, the analytical solution is simply given by the exponential:</p><pre><code class="language-julia hljs">u = exp.(-sol.t / τ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">15-element Vector{Measurements.Measurement{Float64}}:
        1.0 ± 0.0
 0.99998151 ± 1.3e-7
  0.9997966 ± 1.4e-6
   0.997949 ± 1.4e-5
    0.97966 ± 0.00014
    0.92652 ± 0.00049
    0.85722 ± 0.00092
     0.7816 ± 0.0013
      0.699 ± 0.0017
     0.6153 ± 0.0021
     0.5326 ± 0.0023
     0.4542 ± 0.0025
     0.3817 ± 0.0026
     0.3163 ± 0.0025
     0.2983 ± 0.0025</code></pre><p>How do the two solutions compare?</p><pre><code class="language-julia hljs">plot(sol.t, sol.u, label = &quot;Numerical&quot;, xlabel = &quot;Years&quot;, ylabel = &quot;Fraction of Carbon-14&quot;)
plot!(sol.t, u, label = &quot;Analytic&quot;)</code></pre><img src="b5a9b7cd.svg" alt="Example block output"/><p>The two curves are perfectly superimposed, indicating that the numerical solution matches the analytic one.  We can check that also the uncertainties are correctly propagated in the numerical solution:</p><pre><code class="language-julia hljs">println(&quot;Quantity of carbon-14 after &quot;, sol.t[11], &quot; years:&quot;)
println(&quot;Numerical: &quot;, sol[11])
println(&quot;Analytic:  &quot;, u[11])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Quantity of carbon-14 after 5207.541628507064 years:
Numerical: 0.5326 ± 0.0023
Analytic:  0.5326 ± 0.0023</code></pre><p>Bullseye. Both the value of the numerical solution and its uncertainty match the analytic solution within the requested tolerance.  We can also note that close to 5730 years after the beginning of the decay (half-life of the radioisotope), the fraction of carbon-14 that survived is about 0.5.</p><h3 id="Simple-pendulum:-Small-angles-approximation"><a class="docs-heading-anchor" href="#Simple-pendulum:-Small-angles-approximation">Simple pendulum: Small angles approximation</a><a id="Simple-pendulum:-Small-angles-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-pendulum:-Small-angles-approximation" title="Permalink"></a></h3><p>The next problem we are going to study is the simple pendulum in the approximation of small angles.  We address this simplified case because there exists an easy analytic solution to compare.</p><p>The differential equation we want to solve is:</p><p class="math-container">\[\ddot{\theta} + \frac{g}{L} \theta = 0\]</p><p>where <span>$g = (9.79 \pm 0.02)~\mathrm{m}/\mathrm{s}^2$</span> is the gravitational acceleration measured where the experiment is carried out, and <span>$L = (1.00 \pm 0.01)~\mathrm{m}$</span> is the length of the pendulum.</p><p>When you set up the problem for <code>DifferentialEquations.jl</code> remember to define the measurements as variables, as seen above.</p><pre><code class="language-julia hljs">using DifferentialEquations, Measurements, Plots

g = 9.79 ± 0.02; # Gravitational constants
L = 1.00 ± 0.01; # Length of the pendulum

#Initial Conditions
u₀ = [0 ± 0, π / 60 ± 0.01] # Initial speed and initial angle
tspan = (0.0, 6.3)

#Define the problem
function simplependulum(du, u, p, t)
    θ = u[1]
    dθ = u[2]
    du[1] = dθ
    du[2] = -(g / L) * θ
end

#Pass to solvers
prob = ODEProblem(simplependulum, u₀, tspan)
sol = solve(prob, Tsit5(), reltol = 1e-6)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 68-element Vector{Float64}:
 0.0
 0.07248248631909444
 0.11977474504982777
 0.17806767401040355
 0.2389097135174905
 0.3037539550992628
 0.3717638639722829
 0.4426963668621525
 0.5162669123311059
 0.5923146283944006
 ⋮
 5.525954290783653
 5.627441172884416
 5.728575515652614
 5.829199971234117
 5.929629941324541
 6.030620315734677
 6.13325058923572
 6.239645256049916
 6.3
u: 68-element Vector{Vector{Measurements.Measurement{Float64}}}:
 [0.0 ± 0.0, 0.052 ± 0.01]
 [0.00376 ± 0.00072, 0.051 ± 0.0097]
 [0.0061 ± 0.0012, 0.0487 ± 0.0093]
 [0.0088 ± 0.0017, 0.0444 ± 0.0085]
 [0.0114 ± 0.0022, 0.0384 ± 0.0073]
 [0.0136 ± 0.0026, 0.0304 ± 0.0058]
 [0.0154 ± 0.0029, 0.0208 ± 0.004]
 [0.0164 ± 0.0031, 0.0097 ± 0.0019]
 [0.0167 ± 0.0032, -0.00233 ± 0.00062]
 [0.0161 ± 0.0031, -0.0146 ± 0.0028]
 ⋮
 [-0.0167 ± 0.0032, 0.0006 ± 0.0046]
 [-0.0158 ± 0.0031, 0.0169 ± 0.0055]
 [-0.0134 ± 0.0027, 0.0315 ± 0.0071]
 [-0.0096 ± 0.0023, 0.0429 ± 0.0087]
 [-0.0049 ± 0.0018, 0.0501 ± 0.0097]
 [0.00033 ± 0.0016, 0.0523 ± 0.01]
 [0.0056 ± 0.0019, 0.0493 ± 0.0096]
 [0.0104 ± 0.0024, 0.0409 ± 0.0085]
 [0.0127 ± 0.0026, 0.0341 ± 0.0076]</code></pre><p>And that&#39;s it! What about comparing it this time to the analytical solution?</p><pre><code class="language-julia hljs">u = u₀[2] .* cos.(sqrt(g / L) .* sol.t)

plot(sol.t, getindex.(sol.u, 2), label = &quot;Numerical&quot;)
plot!(sol.t, u, label = &quot;Analytic&quot;)</code></pre><img src="71100a75.svg" alt="Example block output"/><p>Bingo. Also in this case there is a perfect superimposition between the two curves, including their uncertainties.</p><p>We can also have a look at the difference between the two solutions:</p><pre><code class="language-julia hljs">plot(sol.t, getindex.(sol.u, 2) .- u, label = &quot;&quot;)</code></pre><img src="9abde6da.svg" alt="Example block output"/><p>Tiny difference on the order of the chosen <code>1e-6</code> tolerance.</p><h3 id="Simple-pendulum:-Arbitrary-amplitude"><a class="docs-heading-anchor" href="#Simple-pendulum:-Arbitrary-amplitude">Simple pendulum: Arbitrary amplitude</a><a id="Simple-pendulum:-Arbitrary-amplitude-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-pendulum:-Arbitrary-amplitude" title="Permalink"></a></h3><p>Now that we know how to solve differential equations involving numbers with uncertainties, we can solve the simple pendulum problem without any approximation. This time, the differential equation to solve is the following:</p><p class="math-container">\[\ddot{\theta} + \frac{g}{L} \sin(\theta) = 0\]</p><p>That would be done via:</p><pre><code class="language-julia hljs">g = 9.79 ± 0.02; # Gravitational constants
L = 1.00 ± 0.01; # Length of the pendulum

#Initial Conditions
u₀ = [0 ± 0, π / 3 ± 0.02] # Initial speed and initial angle
tspan = (0.0, 6.3)

#Define the problem
function simplependulum(du, u, p, t)
    θ = u[1]
    dθ = u[2]
    du[1] = dθ
    du[2] = -(g / L) * sin(θ)
end

#Pass to solvers
prob = ODEProblem(simplependulum, u₀, tspan)
sol = solve(prob, Tsit5(), reltol = 1e-6)

plot(sol.t, getindex.(sol.u, 2), label = &quot;Numerical&quot;)</code></pre><img src="d8b96d54.svg" alt="Example block output"/><h3 id="Warning-about-Linear-Uncertainty-Propagation"><a class="docs-heading-anchor" href="#Warning-about-Linear-Uncertainty-Propagation">Warning about Linear Uncertainty Propagation</a><a id="Warning-about-Linear-Uncertainty-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#Warning-about-Linear-Uncertainty-Propagation" title="Permalink"></a></h3><p>Measurements.jl uses linear uncertainty propagation, which has an error associated with it. <a href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/comparison/">MonteCarloMeasurements.jl has a page which showcases where this method can lead to incorrect uncertainty measurements</a>. Thus for more nonlinear use cases, it&#39;s suggested that one uses one of the more powerful UQ methods, such as:</p><ul><li><a href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/">MonteCarloMeasurements.jl</a></li><li><a href="https://docs.sciml.ai/PolyChaos/stable/">PolyChaos.jl</a></li><li><a href="https://docs.sciml.ai/SciMLExpectations/stable/">SciMLExpectations.jl</a></li><li><a href="https://docs.sciml.ai/DiffEqCallbacks/stable/uncertainty_quantification/">The ProbInts Uncertainty Quantification callbacks</a></li></ul><p>Basically, types can make the algorithm you want to run exceedingly simple to do, but make sure it&#39;s the correct algorithm!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gpu_spde/">« GPU-Accelerated Stochastic Partial Differential Equations</a><a class="docs-footer-nextpage" href="../symbolic_analysis/">Symbolic-Numeric Analysis of Parameter Identifiability and Model Stability »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.1 on <span class="colophon-date" title="Friday 13 October 2023 16:26">Friday 13 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
